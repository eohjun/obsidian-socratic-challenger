/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var V=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.prototype.hasOwnProperty;var se=(o,s)=>{for(var e in s)V(o,e,{get:s[e],enumerable:!0})},ne=(o,s,e,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let n of ee(s))!te.call(o,n)&&n!==e&&V(o,n,{get:()=>s[n],enumerable:!(t=Z(s,n))||t.enumerable});return o};var ie=o=>ne(V({},"__esModule",{value:!0}),o);var de={};se(de,{default:()=>F});module.exports=ie(de);var S=require("obsidian");var B=class{constructor(s){this.providers=new Map;this.settings=s}registerProvider(s,e){this.providers.set(s,e)}updateSettings(s){this.settings=s}getCurrentProvider(){return this.providers.get(this.settings.provider)}getCurrentApiKey(){return this.settings.apiKeys[this.settings.provider]}getCurrentModel(){return this.settings.models[this.settings.provider]}isAvailable(){let s=this.getCurrentProvider(),e=this.getCurrentApiKey();return!!s&&!!e}async generateText(s,e){let t=this.getCurrentProvider();return t?t.isAvailable()?t.generate(s,e):{success:!1,content:"",error:"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."}:{success:!1,content:"",error:"\uD504\uB85C\uBC14\uC774\uB354\uAC00 \uC120\uD0DD\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."}}async simpleGenerate(s,e,t){let n=[];return e&&n.push({role:"system",content:e}),n.push({role:"user",content:s}),this.generateText(n,t)}getAvailableProviders(){return Array.from(this.providers.keys())}isProviderConfigured(s){return!!this.settings.apiKeys[s]}},D=null;function U(o){return D=new B(o),D}function j(){return D}function z(o){D&&D.updateSettings(o)}var J=require("obsidian");var I={claude:{id:"claude",name:"Anthropic Claude",displayName:"Claude",endpoint:"https://api.anthropic.com/v1",defaultModel:"claude-sonnet-4-5-20250929"},gemini:{id:"gemini",name:"Google Gemini",displayName:"Gemini",endpoint:"https://generativelanguage.googleapis.com/v1beta",apiKeyPrefix:"AIza",defaultModel:"gemini-3-flash-preview"},openai:{id:"openai",name:"OpenAI",displayName:"OpenAI",endpoint:"https://api.openai.com/v1",apiKeyPrefix:"sk-",defaultModel:"gpt-5.2"},grok:{id:"grok",name:"xAI Grok",displayName:"Grok",endpoint:"https://api.x.ai/v1",defaultModel:"grok-4-1-fast"}},re={"claude-sonnet-4-5-20250929":{id:"claude-sonnet-4-5-20250929",displayName:"Claude Sonnet 4.5",provider:"claude",maxTokens:16384},"claude-3-5-haiku-20241022":{id:"claude-3-5-haiku-20241022",displayName:"Claude 3.5 Haiku",provider:"claude",maxTokens:8192},"gemini-3-flash-preview":{id:"gemini-3-flash-preview",displayName:"Gemini 3 Flash",provider:"gemini",maxTokens:65536},"gemini-2.0-flash":{id:"gemini-2.0-flash",displayName:"Gemini 2.0 Flash",provider:"gemini",maxTokens:8192},"gpt-5.2":{id:"gpt-5.2",displayName:"GPT-5.2",provider:"openai",maxTokens:32768},"gpt-4o-mini":{id:"gpt-4o-mini",displayName:"GPT-4o Mini",provider:"openai",maxTokens:16384},"grok-4-1-fast":{id:"grok-4-1-fast",displayName:"Grok 4.1 Fast",provider:"grok",maxTokens:16384}};function X(o){return Object.values(re).filter(s=>s.provider===o)}var f=class{constructor(){this.apiKey="";this.model=""}get modelId(){return this.model||this.config.defaultModel}get config(){return I[this.providerType]}setApiKey(s){this.apiKey=s}setModel(s){this.model=s}isAvailable(){return!!this.apiKey}async makeRequest(s){try{return(await(0,J.requestUrl)(s)).json}catch(e){throw this.normalizeError(e)}}handleError(s){return{success:!1,content:"",error:this.normalizeError(s).message}}normalizeError(s){return s instanceof Error?s.message.includes("429")||s.message.includes("rate")?{message:"\uC694\uCCAD \uD55C\uB3C4\uB97C \uCD08\uACFC\uD588\uC2B5\uB2C8\uB2E4. \uC7A0\uC2DC \uD6C4 \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.",code:"RATE_LIMIT"}:s.message.includes("401")||s.message.includes("403")?{message:"API \uD0A4\uAC00 \uC720\uD6A8\uD558\uC9C0 \uC54A\uAC70\uB098 \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.",code:"AUTH_ERROR"}:s.message.includes("timeout")||s.message.includes("ETIMEDOUT")?{message:"\uC694\uCCAD \uC2DC\uAC04\uC774 \uCD08\uACFC\uB418\uC5C8\uC2B5\uB2C8\uB2E4. \uB2E4\uC2DC \uC2DC\uB3C4\uD574\uC8FC\uC138\uC694.",code:"TIMEOUT"}:{message:s.message,code:"UNKNOWN"}:{message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.",code:"UNKNOWN"}}async testApiKey(){var s;if(!this.apiKey)return{success:!1,message:"API \uD0A4\uAC00 \uC785\uB825\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."};try{let e=await this.simpleGenerate("Hi",void 0,{maxTokens:5});return e.success?{success:!0,message:"API \uD0A4\uAC00 \uC720\uD6A8\uD569\uB2C8\uB2E4!"}:{success:!1,message:(s=e.error)!=null?s:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958"}}catch(e){return e instanceof Error?{success:!1,message:e.message}:typeof e=="object"&&e!==null&&"message"in e?{success:!1,message:e.message}:{success:!1,message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4."}}}async simpleGenerate(s,e,t){let n=[];return e&&n.push({role:"system",content:e}),n.push({role:"user",content:s}),this.generate(n,t)}};var w=class extends f{constructor(){super(...arguments);this.providerType="claude";this.name="Anthropic Claude";this.API_VERSION="2023-06-01"}async generate(e,t){var a,u;if(!this.isAvailable())return{success:!1,content:"",error:"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."};let{claudeMessages:n,systemPrompt:i}=this.convertMessages(e),r={model:this.modelId,messages:n,max_tokens:(a=t==null?void 0:t.maxTokens)!=null?a:4096,temperature:(u=t==null?void 0:t.temperature)!=null?u:.7};i&&(r.system=i);try{let p=await this.makeRequest({url:`${this.config.endpoint}/messages`,method:"POST",headers:{"x-api-key":this.apiKey,"anthropic-version":this.API_VERSION,"Content-Type":"application/json"},body:JSON.stringify(r)});return p.error?{success:!1,content:"",error:p.error.message}:{success:!0,content:p.content.filter(g=>g.type==="text").map(g=>g.text).join(""),usage:p.usage?{inputTokens:p.usage.input_tokens,outputTokens:p.usage.output_tokens,totalTokens:p.usage.input_tokens+p.usage.output_tokens}:void 0}}catch(p){return this.handleError(p)}}convertMessages(e){let t=[],n=null;for(let i of e)i.role==="system"?n=i.content:t.push({role:i.role,content:i.content});return{claudeMessages:t,systemPrompt:n}}};var E=class extends f{constructor(){super(...arguments);this.providerType="openai";this.name="OpenAI"}async generate(e,t){var r,a,u,p,h,g;if(!this.isAvailable())return{success:!1,content:"",error:"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."};let n=e.map(c=>({role:c.role,content:c.content})),i={model:this.modelId,messages:n,max_tokens:(r=t==null?void 0:t.maxTokens)!=null?r:4096,temperature:(a=t==null?void 0:t.temperature)!=null?a:.7};(t==null?void 0:t.topP)!==void 0&&(i.top_p=t.topP),t!=null&&t.stopSequences&&(i.stop=t.stopSequences);try{let c=await this.makeRequest({url:`${this.config.endpoint}/chat/completions`,method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify(i)});return c.error?{success:!1,content:"",error:c.error.message}:{success:!0,content:(g=(h=(p=(u=c.choices)==null?void 0:u[0])==null?void 0:p.message)==null?void 0:h.content)!=null?g:"",usage:c.usage?{inputTokens:c.usage.prompt_tokens,outputTokens:c.usage.completion_tokens,totalTokens:c.usage.total_tokens}:void 0}}catch(c){return this.handleError(c)}}};var k=class extends f{constructor(){super(...arguments);this.providerType="gemini";this.name="Google Gemini"}async generate(e,t){var a,u,p,h,g,c,A;if(!this.isAvailable())return{success:!1,content:"",error:"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."};let{contents:n,systemInstruction:i}=this.convertMessages(e),r={contents:n,generationConfig:{maxOutputTokens:(a=t==null?void 0:t.maxTokens)!=null?a:4096,temperature:(u=t==null?void 0:t.temperature)!=null?u:.7}};i&&(r.systemInstruction=i),(t==null?void 0:t.topP)!==void 0&&r.generationConfig&&(r.generationConfig.topP=t.topP),t!=null&&t.stopSequences&&r.generationConfig&&(r.generationConfig.stopSequences=t.stopSequences);try{let C=`${this.config.endpoint}/models/${this.modelId}:generateContent?key=${this.apiKey}`,y=await this.makeRequest({url:C,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});return y.error?{success:!1,content:"",error:y.error.message}:{success:!0,content:(A=(c=(g=(h=(p=y.candidates)==null?void 0:p[0])==null?void 0:h.content)==null?void 0:g.parts)==null?void 0:c.map(Y=>Y.text).join(""))!=null?A:"",usage:y.usageMetadata?{inputTokens:y.usageMetadata.promptTokenCount,outputTokens:y.usageMetadata.candidatesTokenCount,totalTokens:y.usageMetadata.promptTokenCount+y.usageMetadata.candidatesTokenCount}:void 0}}catch(C){return this.handleError(C)}}convertMessages(e){let t=[],n=null;for(let i of e)i.role==="system"?n={parts:[{text:i.content}]}:t.push({role:i.role==="assistant"?"model":"user",parts:[{text:i.content}]});return{contents:t,systemInstruction:n}}};var O=class extends f{constructor(){super(...arguments);this.providerType="grok";this.name="xAI Grok"}async generate(e,t){var r,a,u,p,h,g;if(!this.isAvailable())return{success:!1,content:"",error:"API \uD0A4\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4."};let n=e.map(c=>({role:c.role,content:c.content})),i={model:this.modelId,messages:n,max_tokens:(r=t==null?void 0:t.maxTokens)!=null?r:4096,temperature:(a=t==null?void 0:t.temperature)!=null?a:.7};(t==null?void 0:t.topP)!==void 0&&(i.top_p=t.topP),t!=null&&t.stopSequences&&(i.stop=t.stopSequences);try{let c=await this.makeRequest({url:`${this.config.endpoint}/chat/completions`,method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify(i)});return c.error?{success:!1,content:"",error:c.error.message}:{success:!0,content:(g=(h=(p=(u=c.choices)==null?void 0:u[0])==null?void 0:p.message)==null?void 0:h.content)!=null?g:"",usage:c.usage?{inputTokens:c.usage.prompt_tokens,outputTokens:c.usage.completion_tokens,totalTokens:c.usage.total_tokens}:void 0}}catch(c){return this.handleError(c)}}};var l=require("obsidian");var R=(t=>(t.GENTLE="GENTLE",t.MODERATE="MODERATE",t.CHALLENGING="CHALLENGING",t))(R||{}),Q={GENTLE:{displayText:"\uBD80\uB4DC\uB7EC\uC6C0",promptModifier:"\uCE5C\uADFC\uD558\uACE0 \uACA9\uB824\uD558\uB294 \uD1A4\uC73C\uB85C, \uD0D0\uAD6C\uB97C \uC720\uB3C4\uD558\uBA70 \uBD80\uB2F4 \uC5C6\uC774 \uC0DD\uAC01\uD574\uBCFC \uC218 \uC788\uB294",description:"\uACA9\uB824\uD558\uBA70 \uBD80\uB4DC\uB7FD\uAC8C \uD0D0\uAD6C\uB97C \uC720\uB3C4\uD569\uB2C8\uB2E4.",cssClass:"intensity-gentle"},MODERATE:{displayText:"\uBCF4\uD1B5",promptModifier:"\uADE0\uD615 \uC7A1\uD78C \uD1A4\uC73C\uB85C, \uC801\uC808\uD788 \uB3C4\uC804\uC801\uC774\uBA74\uC11C\uB3C4 \uAC74\uC124\uC801\uC778",description:"\uADE0\uD615 \uC7A1\uD78C \uB3C4\uC804\uC801 \uC9C8\uBB38\uC744 \uC81C\uC2DC\uD569\uB2C8\uB2E4.",cssClass:"intensity-moderate"},CHALLENGING:{displayText:"\uB3C4\uC804\uC801",promptModifier:"\uC9C1\uC811\uC801\uC774\uACE0 \uB0A0\uCE74\uB85C\uC6B4 \uD1A4\uC73C\uB85C, \uB17C\uC99D\uC758 \uC57D\uC810\uC744 \uC815\uBA74\uC73C\uB85C \uD30C\uACE0\uB4DC\uB294",description:"\uAC15\uD558\uAC8C \uB17C\uC99D\uC744 \uAC80\uC99D\uD558\uACE0 \uC57D\uC810\uC744 \uC9C0\uC801\uD569\uB2C8\uB2E4.",cssClass:"intensity-challenging"}},v=class o{constructor(s){this.value=s}static create(s){let e=typeof s=="string"?R[s]:s;if(!e||!Object.values(R).includes(e))throw new Error(`Invalid intensity level: ${s}`);return new o(e)}static all(){return Object.values(R).map(s=>new o(s))}static default(){return new o("MODERATE")}getValue(){return this.value}getDisplayText(){return Q[this.value].displayText}getPromptModifier(){return Q[this.value].promptModifier}getDescription(){return Q[this.value].description}getCssClass(){return Q[this.value].cssClass}getInfo(){return{level:this.value,...Q[this.value]}}equals(s){return this.value===s.value}toString(){return this.value}};var L=(i=>(i.ASSUMPTION="ASSUMPTION",i.PERSPECTIVE="PERSPECTIVE",i.EXPANSION="EXPANSION",i.CLARIFICATION="CLARIFICATION",i.IMPLICATION="IMPLICATION",i))(L||{}),_={ASSUMPTION:{displayText:"\uAC00\uC815 \uB3C4\uC804",icon:"\u{1F50D}",promptHint:"\uC774 \uC8FC\uC7A5\uC758 \uC228\uACA8\uC9C4 \uC804\uC81C\uB098 \uAC00\uC815\uC744 \uAC80\uD1A0\uD558\uB294 \uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uC138\uC694.",description:"\uC228\uACA8\uC9C4 \uC804\uC81C\uC640 \uB2F9\uC5F0\uC2DC\uB418\uB294 \uAC00\uC815\uC744 \uAC80\uD1A0\uD569\uB2C8\uB2E4."},PERSPECTIVE:{displayText:"\uAD00\uC810 \uC804\uD658",icon:"\u{1F441}\uFE0F",promptHint:"\uB2E4\uB978 \uAD00\uC810\uC774\uB098 \uC2DC\uAC01\uC5D0\uC11C \uC774 \uC544\uC774\uB514\uC5B4\uB97C \uBC14\uB77C\uBCF4\uB294 \uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uC138\uC694.",description:"\uB2E4\uB978 \uC785\uC7A5\uC774\uB098 \uC2DC\uAC04\uB300\uC5D0\uC11C \uBC14\uB77C\uBCF4\uB294 \uC2DC\uAC01\uC744 \uD0D0\uAD6C\uD569\uB2C8\uB2E4."},EXPANSION:{displayText:"\uD655\uC7A5",icon:"\u{1F310}",promptHint:"\uC774 \uC544\uC774\uB514\uC5B4\uB97C \uB354 \uB113\uC740 \uB9E5\uB77D\uC5D0\uC11C \uC5F0\uACB0\uD558\uAC70\uB098 \uD655\uC7A5\uD558\uB294 \uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uC138\uC694.",description:"\uB354 \uB113\uC740 \uB9E5\uB77D\uACFC \uB2E4\uB978 \uC601\uC5ED\uACFC\uC758 \uC5F0\uACB0\uC744 \uD0D0\uAD6C\uD569\uB2C8\uB2E4."},CLARIFICATION:{displayText:"\uBA85\uD655\uD654",icon:"\u{1F4A1}",promptHint:"\uBAA8\uD638\uD558\uAC70\uB098 \uBD88\uBA85\uD655\uD55C \uBD80\uBD84\uC744 \uAD6C\uCCB4\uD654\uD558\uB294 \uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uC138\uC694.",description:"\uBAA8\uD638\uD55C \uAC1C\uB150\uC774\uB098 \uD45C\uD604\uC744 \uAD6C\uCCB4\uD654\uD569\uB2C8\uB2E4."},IMPLICATION:{displayText:"\uD568\uC758",icon:"\u{1F3AF}",promptHint:"\uC774 \uC544\uC774\uB514\uC5B4\uC758 \uACB0\uB860, \uC601\uD5A5, \uD55C\uACC4\uB97C \uD0D0\uAD6C\uD558\uB294 \uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uC138\uC694.",description:"\uB17C\uB9AC\uC801 \uACB0\uB860\uACFC \uC2E4\uC81C\uC801 \uC601\uD5A5\uC744 \uD0D0\uAD6C\uD569\uB2C8\uB2E4."}},d=class o{constructor(s){this.value=s}static create(s){let e=typeof s=="string"?L[s]:s;if(!e||!Object.values(L).includes(e))throw new Error(`Invalid question type: ${s}`);return new o(e)}static all(){return Object.values(L).map(s=>new o(s))}getValue(){return this.value}getDisplayText(){return _[this.value].displayText}getIcon(){return _[this.value].icon}getPromptHint(){return _[this.value].promptHint}getDescription(){return _[this.value].description}getInfo(){return{type:this.value,..._[this.value]}}equals(s){return this.value===s.value}toString(){return this.value}};var T=class o{constructor(s,e,t,n){this._id=s;this._type=e;this._content=t;this._createdAt=n}static create(s,e){let t=s instanceof d?s:d.create(s);return new o(o.generateId(),t,e,new Date)}static fromData(s){return new o(s.id,d.create(s.type),s.content,new Date(s.createdAt))}static generateId(){return`q_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}get id(){return this._id}get type(){return this._type}get content(){return this._content}get createdAt(){return this._createdAt}getTypeDisplayText(){return this._type.getDisplayText()}getTypeIcon(){return this._type.getIcon()}toData(){return{id:this._id,type:this._type.getValue(),content:this._content,createdAt:this._createdAt.getTime()}}toMarkdown(){let s=this._type.getIcon(),e=this._type.getDisplayText();return`**${s} ${e}**: ${this._content}`}};var M=class o{constructor(s,e,t,n,i,r){this._id=s;this._noteId=e;this._notePath=t;this._noteContext=n;this._intensity=i;this._createdAt=r;this._questions=[];this._responses=new Map;this._updatedAt=this._createdAt}static create(s,e,t,n){return new o(o.generateId(),s,e,t,n!=null?n:v.default(),new Date)}static fromData(s){let e=new o(s.id,s.noteId,s.notePath,s.noteContext,v.create(s.intensity),new Date(s.createdAt));return s.questions.forEach(t=>{e._questions.push(T.fromData(t))}),s.responses.forEach(t=>{e._responses.set(t.questionId,t)}),e._updatedAt=new Date(s.updatedAt),e}static generateId(){return`session_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}get id(){return this._id}get noteId(){return this._noteId}get notePath(){return this._notePath}get noteContext(){return this._noteContext}get intensity(){return this._intensity}get questions(){return this._questions}get createdAt(){return this._createdAt}get updatedAt(){return this._updatedAt}addQuestion(s){this._questions.push(s),this._updatedAt=new Date}addQuestions(s){s.forEach(e=>this._questions.push(e)),this._updatedAt=new Date}addResponse(s,e){if(!this._questions.find(n=>n.id===s))throw new Error(`Question not found: ${s}`);this._responses.set(s,{questionId:s,content:e,createdAt:Date.now()}),this._updatedAt=new Date}getResponse(s){return this._responses.get(s)}setIntensity(s){this._intensity=s,this._updatedAt=new Date}getHistory(){return this._questions.map(s=>{var t;let e=this._responses.get(s.id);return{question:s,response:(t=e==null?void 0:e.content)!=null?t:null,responseCreatedAt:e?new Date(e.createdAt):null}})}getUnansweredQuestions(){return this._questions.filter(s=>!this._responses.has(s.id))}getAnsweredQuestions(){return this._questions.filter(s=>this._responses.has(s.id))}hasUnansweredQuestions(){return this.getUnansweredQuestions().length>0}getLastExchange(){let s=this.getAnsweredQuestions();if(s.length===0)return null;let e=s[s.length-1],t=this._responses.get(e.id);return t?{question:e,response:t.content}:null}toData(){return{id:this._id,noteId:this._noteId,notePath:this._notePath,noteContext:this._noteContext,questions:this._questions.map(s=>s.toData()),responses:Array.from(this._responses.values()),intensity:this._intensity.getValue(),createdAt:this._createdAt.getTime(),updatedAt:this._updatedAt.getTime()}}toMarkdown(){let s=["## Socratic Dialogue","",`**\uC2DC\uC791 \uC2DC\uAC04**: ${this._createdAt.toLocaleString("ko-KR")}`,`**\uAC15\uB3C4**: ${this._intensity.getDisplayText()}`,"","---",""];return this._questions.forEach((e,t)=>{let n=this._responses.get(e.id);s.push(`### Q${t+1}. ${e.getTypeIcon()} ${e.getTypeDisplayText()}`),s.push(""),s.push(`> ${e.content}`),s.push(""),n&&(s.push("**\uB098\uC758 \uB2F5\uBCC0:**"),s.push(""),s.push(n.content),s.push("")),s.push("---"),s.push("")}),s.join(`
`)}};var oe=`\uB2F9\uC2E0\uC740 \uC18C\uD06C\uB77C\uD14C\uC2A4\uC2DD \uB300\uD654\uC758 \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4.
\uC0AC\uC6A9\uC790\uAC00 \uC791\uC131\uD55C \uB178\uD2B8\uB098 \uC544\uC774\uB514\uC5B4\uC5D0 \uB300\uD574 \uAE4A\uC774 \uC788\uB294 \uC0AC\uACE0\uB97C \uCD09\uC9C4\uD558\uB294 \uC9C8\uBB38\uC744 \uC0DD\uC131\uD569\uB2C8\uB2E4.

**\uC911\uC694\uD55C \uC6D0\uCE59:**
- \uC9C8\uBB38\uC740 \uBC18\uB4DC\uC2DC \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD569\uB2C8\uB2E4.
- \uC9C8\uBB38\uC740 \uC5F4\uB9B0 \uC9C8\uBB38 \uD615\uD0DC\uB85C, \uC608/\uC544\uB2C8\uC624\uB85C \uB2F5\uD560 \uC218 \uC5C6\uC5B4\uC57C \uD569\uB2C8\uB2E4.
- \uBE44\uD310\uC801\uC774\uC9C0\uB9CC \uACF5\uACA9\uC801\uC774\uC9C0 \uC54A\uC740 \uD1A4\uC744 \uC720\uC9C0\uD569\uB2C8\uB2E4.
- \uC0AC\uC6A9\uC790\uC758 \uC0AC\uACE0\uB97C \uD655\uC7A5\uD558\uACE0 \uAE4A\uAC8C \uD558\uB294 \uAC83\uC774 \uBAA9\uD45C\uC785\uB2C8\uB2E4.

**\uC9C8\uBB38 \uC720\uD615\uBCC4 \uC608\uC2DC:**

\u{1F50D} \uAC00\uC815 \uB3C4\uC804 (ASSUMPTION):
- "\uC774 \uC8FC\uC7A5\uC774 \uCC38\uC774 \uB418\uB824\uBA74 \uC5B4\uB5A4 \uC870\uAC74\uC774 \uC804\uC81C\uB418\uC5B4\uC57C \uD560\uAE4C\uC694?"
- "\uC774\uAC83\uC774 \uD56D\uC0C1 \uCC38\uC774\uB77C\uACE0 \uAC00\uC815\uD558\uB294 \uADFC\uAC70\uB294 \uBB34\uC5C7\uC778\uAC00\uC694?"
- "\uC774 \uAC00\uC815\uC5D0 \uBC18\uB840\uAC00 \uC788\uC744 \uC218 \uC788\uC744\uAE4C\uC694?"

\u{1F441}\uFE0F \uAD00\uC810 \uC804\uD658 (PERSPECTIVE):
- "\uB9CC\uC57D \uBC18\uB300 \uC785\uC7A5\uC5D0 \uC788\uB294 \uC0AC\uB78C\uC774\uB77C\uBA74 \uC774\uAC83\uC744 \uC5B4\uB5BB\uAC8C \uBCFC\uAE4C\uC694?"
- "10\uB144 \uD6C4\uC5D0\uB3C4 \uC774 \uAD00\uC810\uC774 \uC720\uD6A8\uD560\uAE4C\uC694?"
- "\uB2E4\uB978 \uBD84\uC57C\uC758 \uC804\uBB38\uAC00\uB294 \uC774\uAC83\uC744 \uC5B4\uB5BB\uAC8C \uD574\uC11D\uD560\uAE4C\uC694?"

\u{1F310} \uD655\uC7A5 (EXPANSION):
- "\uC774 \uC544\uC774\uB514\uC5B4\uB97C \uB2E4\uB978 \uC601\uC5ED\uC5D0 \uC801\uC6A9\uD558\uBA74 \uC5B4\uB5A4 \uACB0\uACFC\uAC00 \uB098\uC62C\uAE4C\uC694?"
- "\uC774\uAC83\uC758 \uD55C\uACC4\uB294 \uBB34\uC5C7\uC778\uAC00\uC694?"
- "\uB354 \uB113\uC740 \uB9E5\uB77D\uC5D0\uC11C \uC774\uAC83\uC740 \uC5B4\uB5A4 \uC758\uBBF8\uB97C \uAC00\uC9C8\uAE4C\uC694?"

\u{1F4A1} \uBA85\uD655\uD654 (CLARIFICATION):
- "'X'\uB77C\uB294 \uAC1C\uB150\uC744 \uC880 \uB354 \uAD6C\uCCB4\uC801\uC73C\uB85C \uC815\uC758\uD55C\uB2E4\uBA74?"
- "\uC774 \uC544\uC774\uB514\uC5B4\uC758 \uD575\uC2EC\uC744 \uD55C \uBB38\uC7A5\uC73C\uB85C \uD45C\uD604\uD55C\uB2E4\uBA74?"
- "\uAC00\uC7A5 \uC911\uC694\uD55C \uC694\uC18C\uB294 \uBB34\uC5C7\uC778\uAC00\uC694?"

\u{1F3AF} \uD568\uC758 (IMPLICATION):
- "\uC774\uAC83\uC774 \uC0AC\uC2E4\uC774\uB77C\uBA74 \uC5B4\uB5A4 \uACB0\uB860\uC774 \uB3C4\uCD9C\uB418\uB098\uC694?"
- "\uC2E4\uC81C\uB85C \uC801\uC6A9\uD588\uC744 \uB54C \uC608\uC0C1\uB418\uB294 \uACB0\uACFC\uB294 \uBB34\uC5C7\uC778\uAC00\uC694?"
- "\uC774 \uC8FC\uC7A5\uC744 \uBC1B\uC544\uB4E4\uC774\uBA74 \uD3EC\uAE30\uD574\uC57C \uD558\uB294 \uAC83\uC740 \uBB34\uC5C7\uC778\uAC00\uC694?"`;function ae(o){var n;let s=o.intensity.getPromptModifier(),e=(n=o.maxQuestions)!=null?n:3,t=o.questionTypes.map(i=>{let r=d.create(i);return`- ${r.getIcon()} ${r.getDisplayText()}: ${r.getPromptHint()}`}).join(`
`);return`\uB2E4\uC74C \uB178\uD2B8 \uB0B4\uC6A9\uC744 \uBD84\uC11D\uD558\uACE0, ${s} \uC9C8\uBB38\uC744 ${e}\uAC1C \uC0DD\uC131\uD574\uC8FC\uC138\uC694.

**\uC694\uCCAD\uD558\uB294 \uC9C8\uBB38 \uC720\uD615:**
${t}

**\uB178\uD2B8 \uB0B4\uC6A9:**
---
${o.noteContent}
---

**\uC751\uB2F5 \uD615\uC2DD:**
\uAC01 \uC9C8\uBB38\uC744 \uB2E4\uC74C JSON \uD615\uC2DD\uC73C\uB85C \uCD9C\uB825\uD558\uC138\uC694:
\`\`\`json
{
  "questions": [
    {"type": "ASSUMPTION", "content": "\uC9C8\uBB38 \uB0B4\uC6A9"},
    {"type": "PERSPECTIVE", "content": "\uC9C8\uBB38 \uB0B4\uC6A9"},
    ...
  ]
}
\`\`\`

\uC9C8\uBB38 \uC720\uD615\uC740 \uBC18\uB4DC\uC2DC \uC694\uCCAD\uB41C \uC720\uD615 \uC911\uC5D0\uC11C \uC120\uD0DD\uD558\uC138\uC694.`}function ue(o){try{let s=o.match(/```(?:json)?\s*([\s\S]*?)```/),e=s?s[1].trim():o.trim(),t=JSON.parse(e);if(!t.questions||!Array.isArray(t.questions))throw new Error("Invalid response format: missing questions array");return t.questions.map(n=>{let i=d.create(n.type);return T.create(i,n.content)})}catch(s){let e=[],t=o.split(`
`);for(let n of t){let i=n.trim();if(i&&i.includes("?")){let r="ASSUMPTION";i.includes("\u{1F50D}")||i.includes("\uAC00\uC815")?r="ASSUMPTION":i.includes("\u{1F441}\uFE0F")||i.includes("\uAD00\uC810")?r="PERSPECTIVE":i.includes("\u{1F310}")||i.includes("\uD655\uC7A5")?r="EXPANSION":i.includes("\u{1F4A1}")||i.includes("\uBA85\uD655")?r="CLARIFICATION":(i.includes("\u{1F3AF}")||i.includes("\uD568\uC758"))&&(r="IMPLICATION");let a=i.replace(/^[-*â€¢]\s*/,"").replace(/^[ðŸ”ðŸ‘ï¸ðŸŒðŸ’¡ðŸŽ¯]\s*/,"").replace(/^\d+\.\s*/,"").trim();a.length>10&&e.push(T.create(d.create(r),a))}}return e}}var q=class{constructor(s){this.llmProvider=s}async execute(s){var i;if(!s.noteContent.trim())return{questions:[],error:"\uB178\uD2B8 \uB0B4\uC6A9\uC774 \uBE44\uC5B4\uC788\uC2B5\uB2C8\uB2E4."};if(s.questionTypes.length===0)return{questions:[],error:"\uC9C8\uBB38 \uC720\uD615\uC744 \uD558\uB098 \uC774\uC0C1 \uC120\uD0DD\uD574\uC8FC\uC138\uC694."};let e=ae(s),t=await this.llmProvider.simpleGenerate(e,oe,{maxTokens:2e3,temperature:.7});if(!t.success)return{questions:[],error:(i=t.error)!=null?i:"LLM \uC694\uCCAD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",rawResponse:t.content};let n=ue(t.content);return n.length===0?{questions:[],error:"\uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4. \uB178\uD2B8 \uB0B4\uC6A9\uC774 \uB108\uBB34 \uC9E7\uAC70\uB098 \uBAA8\uD638\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.",rawResponse:t.content}:{questions:n,rawResponse:t.content}}};var ce=`\uB2F9\uC2E0\uC740 \uC18C\uD06C\uB77C\uD14C\uC2A4\uC2DD \uB300\uD654\uC758 \uC804\uBB38\uAC00\uC785\uB2C8\uB2E4.
\uC774\uC804 \uB300\uD654 \uB9E5\uB77D\uC744 \uBC14\uD0D5\uC73C\uB85C \uB354 \uAE4A\uC740 \uD0D0\uAD6C\uB97C \uC704\uD55C \uD6C4\uC18D \uC9C8\uBB38\uC744 \uC0DD\uC131\uD569\uB2C8\uB2E4.

**\uC911\uC694\uD55C \uC6D0\uCE59:**
- \uC9C8\uBB38\uC740 \uBC18\uB4DC\uC2DC \uD55C\uAD6D\uC5B4\uB85C \uC791\uC131\uD569\uB2C8\uB2E4.
- \uC774\uC804 \uC751\uB2F5\uC5D0\uC11C \uBC1C\uACAC\uB41C \uC0C8\uB85C\uC6B4 \uAC00\uC815\uC774\uB098 \uC544\uC774\uB514\uC5B4\uB97C \uD30C\uACE0\uB4ED\uB2C8\uB2E4.
- \uC0AC\uC6A9\uC790\uAC00 \uB193\uCCE4\uC744 \uC218 \uC788\uB294 \uBD80\uBD84\uC744 \uD0D0\uAD6C\uD569\uB2C8\uB2E4.
- \uC0AC\uACE0\uB97C \uD55C \uB2E8\uACC4 \uB354 \uAE4A\uAC8C \uD558\uB294 \uAC83\uC774 \uBAA9\uD45C\uC785\uB2C8\uB2E4.
- \uC774\uC804\uACFC \uC911\uBCF5\uB418\uB294 \uC9C8\uBB38\uC740 \uD53C\uD569\uB2C8\uB2E4.`;function pe(o){var p,h,g,c;let s=o.session,e=s.getHistory(),t=s.getLastExchange(),n=s.intensity.getPromptModifier(),i=(p=o.maxQuestions)!=null?p:2,r=e.map((A,C)=>{let y=A.question,K=A.response;return`Q${C+1}. ${y.getTypeIcon()} ${y.content}
${K?`A${C+1}. ${K}`:"(\uC544\uC9C1 \uB2F5\uBCC0 \uC5C6\uC74C)"}`}).join(`

`),u=((h=o.questionTypes)!=null?h:["ASSUMPTION","EXPANSION","IMPLICATION"]).map(A=>{let C=d.create(A);return`- ${C.getIcon()} ${C.getDisplayText()}`}).join(`
`);return`\uB2E4\uC74C \uB300\uD654\uB97C \uBD84\uC11D\uD558\uACE0, ${n} \uD6C4\uC18D \uC9C8\uBB38\uC744 ${i}\uAC1C \uC0DD\uC131\uD574\uC8FC\uC138\uC694.

**\uC6D0\uBCF8 \uB178\uD2B8:**
---
${s.noteContext}
---

**\uC9C0\uAE08\uAE4C\uC9C0\uC758 \uB300\uD654:**
---
${r}
---

**\uAC00\uC7A5 \uCD5C\uADFC \uAD50\uD658:**
\uC9C8\uBB38: ${(g=t==null?void 0:t.question.content)!=null?g:"(\uC5C6\uC74C)"}
\uC751\uB2F5: ${(c=t==null?void 0:t.response)!=null?c:"(\uC5C6\uC74C)"}

**\uC694\uCCAD\uD558\uB294 \uC9C8\uBB38 \uC720\uD615:**
${u}

**\uC751\uB2F5 \uD615\uC2DD:**
\`\`\`json
{
  "questions": [
    {"type": "EXPANSION", "content": "\uD6C4\uC18D \uC9C8\uBB38 \uB0B4\uC6A9"},
    {"type": "IMPLICATION", "content": "\uD6C4\uC18D \uC9C8\uBB38 \uB0B4\uC6A9"}
  ]
}
\`\`\`

\uC0AC\uC6A9\uC790\uC758 \uB9C8\uC9C0\uB9C9 \uC751\uB2F5\uC5D0\uC11C \uBC1C\uACAC\uB41C \uC0C8\uB85C\uC6B4 \uAC00\uC815, \uD568\uC758, \uB610\uB294 \uD655\uC7A5 \uAC00\uB2A5\uD55C \uC544\uC774\uB514\uC5B4\uB97C \uD30C\uACE0\uB4DC\uC138\uC694.
\uC774\uC804\uC5D0 \uC774\uBBF8 \uBB3C\uC5B4\uBCF8 \uC9C8\uBB38\uACFC \uC911\uBCF5\uB418\uC9C0 \uC54A\uB3C4\uB85D \uD558\uC138\uC694.`}function le(o){try{let s=o.match(/```(?:json)?\s*([\s\S]*?)```/),e=s?s[1].trim():o.trim(),t=JSON.parse(e);if(!t.questions||!Array.isArray(t.questions))throw new Error("Invalid response format");return t.questions.map(n=>{let i=d.create(n.type);return T.create(i,n.content)})}catch(s){let e=[],t=o.split(`
`);for(let n of t){let i=n.trim();if(i&&i.includes("?")){let r="EXPANSION";i.includes("\uAC00\uC815")||i.includes("\u{1F50D}")?r="ASSUMPTION":(i.includes("\uD568\uC758")||i.includes("\u{1F3AF}"))&&(r="IMPLICATION");let a=i.replace(/^[-*â€¢]\s*/,"").replace(/^[ðŸ”ðŸ‘ï¸ðŸŒðŸ’¡ðŸŽ¯]\s*/,"").replace(/^\d+\.\s*/,"").trim();a.length>10&&e.push(T.create(d.create(r),a))}}return e}}var b=class{constructor(s){this.llmProvider=s}async execute(s){var r;if(s.session.getAnsweredQuestions().length===0)return{questions:[],error:"\uD6C4\uC18D \uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uB824\uBA74 \uBA3C\uC800 \uD558\uB098 \uC774\uC0C1\uC758 \uC9C8\uBB38\uC5D0 \uB2F5\uBCC0\uD574\uC8FC\uC138\uC694."};let t=pe(s),n=await this.llmProvider.simpleGenerate(t,ce,{maxTokens:1500,temperature:.7});if(!n.success)return{questions:[],error:(r=n.error)!=null?r:"LLM \uC694\uCCAD\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",rawResponse:n.content};let i=le(n.content);return i.length===0?{questions:[],error:"\uD6C4\uC18D \uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.",rawResponse:n.content}:{questions:i,rawResponse:n.content}}};var W="## Socratic Dialogue",$="%%SOCRATIC_DATA_START%%",H="%%SOCRATIC_DATA_END%%",G=class{constructor(s){this.app=s}async save(s){let e=this.app.vault.getAbstractFileByPath(s.notePath);if(!e||!(e instanceof this.app.vault.adapter.constructor)){let t=this.app.vault.getFileByPath(s.notePath);if(!t)throw new Error(`\uB178\uD2B8\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4: ${s.notePath}`);await this.saveToFile(t,s)}else await this.saveToFile(e,s)}async saveToFile(s,e){let t=await this.app.vault.read(s),n=this.updateContentWithSession(t,e);await this.app.vault.modify(s,n)}updateContentWithSession(s,e){var c;let t=e.toMarkdown(),n=JSON.stringify(e.toData()),i=`
${$}
${n}
${H}
`,r=s.indexOf(W);if(r===-1)return`${s.trim()}

---

${t}${i}`;let a=s.substring(r),u=a.match(/\n## [^\n]+/),p=u?r+((c=u.index)!=null?c:a.length):s.length,h=s.substring(0,r),g=s.substring(p);return`${h.trim()}

${t}${i}
${g.trim()}`.trim()+`
`}async findByNoteId(s){let e=await this.getHistory(s);return e.length>0?e[0]:null}async getHistory(s){let e=this.app.vault.getFileByPath(s);if(!e)return[];try{let t=await this.app.vault.read(e);return this.parseSessionsFromContent(t)}catch(t){return[]}}parseSessionsFromContent(s){let e=[],t=new RegExp(`${$}\\n([\\s\\S]*?)\\n${H}`,"g"),n;for(;(n=t.exec(s))!==null;)try{let i=n[1].trim(),r=JSON.parse(i);e.push(M.fromData(r))}catch(i){console.warn("Failed to parse dialogue session data")}return e}async delete(s){let e=this.app.vault.getMarkdownFiles();for(let t of e){let n=await this.app.vault.read(t);if(n.includes(s)){let i=new RegExp(`${$}\\n[\\s\\S]*?"id"\\s*:\\s*"${s}"[\\s\\S]*?\\n${H}`,"g"),r=n.replace(i,"");if(r.includes($))await this.app.vault.modify(t,r);else{let a=new RegExp(`\\n*---\\n*\\n*${W}[\\s\\S]*$`,""),u=r.replace(a,"").trim()+`
`;await this.app.vault.modify(t,u)}break}}}};var N=class extends l.Modal{constructor(e,t,n,i){super(e);this.session=null;this.responseInputs=new Map;this.questionContainer=null;this.actionsContainer=null;this.isLoading=!1;this.plugin=t,this.noteContent=n,this.notePath=i,this.noteId=i,this.selectedTypes=[...t.settings.dialogue.defaultQuestionTypes],this.selectedIntensity=v.create(t.settings.dialogue.defaultIntensity),this.questionCount=t.settings.dialogue.defaultQuestionCount}onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("socratic-challenger-modal"),this.renderHeader(e),this.renderNoteContext(e),this.renderControls(e),this.renderQuestionArea(e),this.renderActions(e)}onClose(){this.contentEl.empty(),this.responseInputs.clear()}renderHeader(e){let t=e.createDiv({cls:"socratic-header"});t.createEl("h2",{text:"\u{1F3DB}\uFE0F Socratic Challenger"}),t.createEl("p",{text:"\uB2F9\uC2E0\uC758 \uC544\uC774\uB514\uC5B4\uC5D0 \uB300\uD574 \uAE4A\uC774 \uC788\uB294 \uC9C8\uBB38\uC744 \uB358\uC838\uB4DC\uB9BD\uB2C8\uB2E4.",cls:"socratic-subtitle"})}renderNoteContext(e){let t=e.createDiv({cls:"socratic-note-context"});t.createEl("h4",{text:"\u{1F4DD} \uB178\uD2B8 \uB0B4\uC6A9"});let n=this.noteContent.length>500?this.noteContent.substring(0,500)+"...":this.noteContent;t.createDiv({cls:"note-content",text:n})}renderControls(e){let t=e.createDiv({cls:"socratic-controls"});new l.Setting(t).setName("\uC9C8\uBB38 \uAC15\uB3C4").addDropdown(i=>{v.all().forEach(r=>{i.addOption(r.getValue(),r.getDisplayText())}),i.setValue(this.selectedIntensity.getValue()),i.onChange(r=>{this.selectedIntensity=v.create(r)})}),new l.Setting(t).setName("\uC9C8\uBB38 \uAC1C\uC218").addDropdown(i=>{for(let r=1;r<=5;r++)i.addOption(r.toString(),`${r}\uAC1C`);i.setValue(this.questionCount.toString()),i.onChange(r=>{this.questionCount=parseInt(r)})});let n=t.createDiv({cls:"socratic-question-types"});n.createEl("span",{text:"\uC9C8\uBB38 \uC720\uD615: "}),d.all().forEach(i=>{let r=i.getInfo(),a=n.createEl("label",{cls:"question-type-toggle"}),u=a.createEl("input",{type:"checkbox"});u.checked=this.selectedTypes.includes(r.type),u.addEventListener("change",()=>{if(u.checked)this.selectedTypes.includes(r.type)||this.selectedTypes.push(r.type);else{let p=this.selectedTypes.indexOf(r.type);p>-1&&this.selectedTypes.splice(p,1)}}),a.createSpan({text:`${r.icon} ${r.displayText}`})})}renderQuestionArea(e){this.questionContainer=e.createDiv({cls:"socratic-question-list"}),this.session||this.questionContainer.createDiv({cls:"socratic-empty-state",text:'"\uC9C8\uBB38 \uC0DD\uC131" \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uC2DC\uC791\uD558\uC138\uC694.'})}renderActions(e){this.actionsContainer=e.createDiv({cls:"socratic-actions"}),this.updateActionButtons()}updateActionButtons(){this.actionsContainer&&(this.actionsContainer.empty(),this.session?(new l.ButtonComponent(this.actionsContainer).setButtonText("\u{1F4AC} \uD6C4\uC18D \uC9C8\uBB38").onClick(()=>this.continueDialogue()),new l.ButtonComponent(this.actionsContainer).setButtonText("\u{1F4BE} \uB300\uD654 \uC800\uC7A5").onClick(()=>this.saveDialogue()),new l.ButtonComponent(this.actionsContainer).setButtonText("\u{1F504} \uC0C8\uB85C \uC2DC\uC791").onClick(()=>this.resetDialogue())):new l.ButtonComponent(this.actionsContainer).setButtonText("\u{1F3AF} \uC9C8\uBB38 \uC0DD\uC131").setCta().onClick(()=>this.generateQuestions()))}async generateQuestions(){if(this.isLoading)return;if(this.selectedTypes.length===0){new l.Notice("\uC9C8\uBB38 \uC720\uD615\uC744 \uD558\uB098 \uC774\uC0C1 \uC120\uD0DD\uD574\uC8FC\uC138\uC694.");return}let e=this.plugin.getCurrentProvider();if(!e){new l.Notice("AI \uD504\uB85C\uBC14\uC774\uB354\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4. \uC124\uC815\uC5D0\uC11C API \uD0A4\uB97C \uC785\uB825\uD574\uC8FC\uC138\uC694.");return}this.setLoading(!0);try{let n=await new q(e).execute({noteContent:this.noteContent,questionTypes:this.selectedTypes,intensity:this.selectedIntensity,maxQuestions:this.questionCount});if(n.error){new l.Notice(`\uC624\uB958: ${n.error}`);return}this.session=M.create(this.noteId,this.notePath,this.noteContent,this.selectedIntensity),this.session.addQuestions(n.questions),this.renderQuestions(),this.updateActionButtons(),new l.Notice(`${n.questions.length}\uAC1C\uC758 \uC9C8\uBB38\uC774 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}catch(t){let n=t instanceof Error?t.message:"\uC9C8\uBB38 \uC0DD\uC131\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.";new l.Notice(`\uC624\uB958: ${n}`)}finally{this.setLoading(!1)}}async continueDialogue(){if(this.isLoading||!this.session)return;if(this.session.getAnsweredQuestions().length===0){new l.Notice("\uD6C4\uC18D \uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uB824\uBA74 \uBA3C\uC800 \uD558\uB098 \uC774\uC0C1\uC758 \uC9C8\uBB38\uC5D0 \uB2F5\uBCC0\uD574\uC8FC\uC138\uC694.");return}let e=this.plugin.getCurrentProvider();if(!e){new l.Notice("AI \uD504\uB85C\uBC14\uC774\uB354\uAC00 \uC124\uC815\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.");return}this.setLoading(!0);try{let n=await new b(e).execute({session:this.session,maxQuestions:2});if(n.error){new l.Notice(`\uC624\uB958: ${n.error}`);return}this.session.addQuestions(n.questions),this.renderQuestions(),new l.Notice(`${n.questions.length}\uAC1C\uC758 \uD6C4\uC18D \uC9C8\uBB38\uC774 \uC0DD\uC131\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)}catch(t){let n=t instanceof Error?t.message:"\uD6C4\uC18D \uC9C8\uBB38 \uC0DD\uC131\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.";new l.Notice(`\uC624\uB958: ${n}`)}finally{this.setLoading(!1)}}renderQuestions(){if(!this.questionContainer||!this.session)return;this.questionContainer.empty(),this.responseInputs.clear(),this.session.questions.forEach((t,n)=>{this.renderQuestionItem(t,n)})}renderQuestionItem(e,t){if(!this.questionContainer||!this.session)return;let n=`question-type-${e.type.getValue().toLowerCase()}`,i=this.questionContainer.createDiv({cls:`socratic-question-item ${n}`});i.createDiv({cls:"question-type",text:`${e.getTypeIcon()} ${e.getTypeDisplayText()}`}),i.createDiv({cls:"question-content",text:`Q${t+1}. ${e.content}`});let r=this.session.getResponse(e.id);if(r){let a=i.createDiv({cls:"socratic-response-saved"});a.createDiv({cls:"response-label",text:"\uB098\uC758 \uB2F5\uBCC0:"}),a.createDiv({text:r.content})}else{let a=i.createDiv({cls:"socratic-response-area"}),u=new l.TextAreaComponent(a);u.setPlaceholder("\uC774 \uC9C8\uBB38\uC5D0 \uB300\uD55C \uC0DD\uAC01\uC744 \uC801\uC5B4\uBCF4\uC138\uC694..."),u.inputEl.rows=3,this.responseInputs.set(e.id,u);let p=new l.ButtonComponent(a);p.setButtonText("\uB2F5\uBCC0 \uC800\uC7A5"),p.onClick(()=>this.saveResponse(e.id))}}saveResponse(e){if(!this.session)return;let t=this.responseInputs.get(e);if(!t)return;let n=t.getValue().trim();if(!n){new l.Notice("\uB2F5\uBCC0\uC744 \uC785\uB825\uD574\uC8FC\uC138\uC694.");return}try{this.session.addResponse(e,n),this.renderQuestions(),new l.Notice("\uB2F5\uBCC0\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(i){let r=i instanceof Error?i.message:"\uB2F5\uBCC0 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.";new l.Notice(`\uC624\uB958: ${r}`)}}async saveDialogue(){if(this.session)try{await new G(this.app).save(this.session),new l.Notice("\uB300\uD654\uAC00 \uB178\uD2B8\uC5D0 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch(e){let t=e instanceof Error?e.message:"\uB300\uD654 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.";new l.Notice(`\uC624\uB958: ${t}`)}}resetDialogue(){this.session=null,this.responseInputs.clear(),this.questionContainer&&(this.questionContainer.empty(),this.questionContainer.createDiv({cls:"socratic-empty-state",text:'"\uC9C8\uBB38 \uC0DD\uC131" \uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC5EC \uC2DC\uC791\uD558\uC138\uC694.'})),this.updateActionButtons(),new l.Notice("\uB300\uD654\uAC00 \uCD08\uAE30\uD654\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}setLoading(e){if(this.isLoading=e,this.questionContainer&&e){this.questionContainer.empty();let t=this.questionContainer.createDiv({cls:"socratic-loading"});t.createSpan({cls:"loading-spinner",text:"\u23F3"}),t.createSpan({text:"\uC9C8\uBB38\uC744 \uC0DD\uC131\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4..."})}}};var m=require("obsidian");var x=class extends m.PluginSettingTab{constructor(e,t){super(e,t);this.modelDropdown=null;this.plugin=t}display(){let{containerEl:e}=this;e.empty(),this.renderAISettings(e),this.renderDialogueSettings(e)}renderAISettings(e){e.createEl("h2",{text:"AI \uC124\uC815"}),new m.Setting(e).setName("AI \uD504\uB85C\uBC14\uC774\uB354").setDesc("\uC0AC\uC6A9\uD560 AI \uC11C\uBE44\uC2A4\uB97C \uC120\uD0DD\uD558\uC138\uC694").addDropdown(n=>{Object.entries(I).forEach(([i,r])=>{n.addOption(i,r.displayName)}),n.setValue(this.plugin.settings.ai.provider),n.onChange(async i=>{this.plugin.settings.ai.provider=i,await this.plugin.saveSettings(),this.updateModelDropdown(),this.display()})});let t=this.plugin.settings.ai.provider;new m.Setting(e).setName(`${I[t].displayName} API \uD0A4`).setDesc("API \uD0A4\uB97C \uC785\uB825\uD558\uC138\uC694").addText(n=>{var i;n.setPlaceholder("API \uD0A4 \uC785\uB825").setValue((i=this.plugin.settings.ai.apiKeys[t])!=null?i:"").onChange(async r=>{this.plugin.settings.ai.apiKeys[t]=r,await this.plugin.saveSettings()}),n.inputEl.type="password"}).addButton(n=>{n.setButtonText("\uD14C\uC2A4\uD2B8").onClick(async()=>{let i=this.plugin.getCurrentProvider();if(!i){new m.Notice("\uD504\uB85C\uBC14\uC774\uB354\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}n.setDisabled(!0),n.setButtonText("\uD14C\uC2A4\uD2B8 \uC911...");try{let r=await i.testApiKey();r.success?new m.Notice(`\u2705 ${r.message}`):new m.Notice(`\u274C ${r.message}`)}catch(r){let a=r instanceof Error?r.message:"\uC54C \uC218 \uC5C6\uB294 \uC624\uB958";new m.Notice(`\u274C \uD14C\uC2A4\uD2B8 \uC2E4\uD328: ${a}`)}finally{n.setDisabled(!1),n.setButtonText("\uD14C\uC2A4\uD2B8")}})}),new m.Setting(e).setName("\uBAA8\uB378").setDesc("\uC0AC\uC6A9\uD560 \uBAA8\uB378\uC744 \uC120\uD0DD\uD558\uC138\uC694").addDropdown(n=>{var i;this.modelDropdown=n,this.populateModelDropdown(n,t),n.setValue((i=this.plugin.settings.ai.models[t])!=null?i:I[t].defaultModel),n.onChange(async r=>{this.plugin.settings.ai.models[t]=r,await this.plugin.saveSettings()})}),new m.Setting(e).setName("\uC608\uC0B0 \uD55C\uB3C4 (USD)").setDesc("\uC6D4\uAC04 API \uC0AC\uC6A9 \uC608\uC0B0 \uD55C\uB3C4\uB97C \uC124\uC815\uD558\uC138\uC694 (\uC120\uD0DD \uC0AC\uD56D)").addText(n=>{var i,r;n.setPlaceholder("\uC608: 10.00").setValue((r=(i=this.plugin.settings.ai.budgetLimit)==null?void 0:i.toString())!=null?r:"").onChange(async a=>{let u=parseFloat(a);this.plugin.settings.ai.budgetLimit=isNaN(u)?void 0:u,await this.plugin.saveSettings()})})}renderDialogueSettings(e){e.createEl("h2",{text:"\uB300\uD654 \uC124\uC815"}),new m.Setting(e).setName("\uAE30\uBCF8 \uC9C8\uBB38 \uAC15\uB3C4").setDesc("\uC9C8\uBB38\uC758 \uAE30\uBCF8 \uAC15\uB3C4\uB97C \uC120\uD0DD\uD558\uC138\uC694").addDropdown(n=>{v.all().forEach(i=>{n.addOption(i.getValue(),i.getDisplayText())}),n.setValue(this.plugin.settings.dialogue.defaultIntensity),n.onChange(async i=>{this.plugin.settings.dialogue.defaultIntensity=i,await this.plugin.saveSettings()})}),new m.Setting(e).setName("\uAE30\uBCF8 \uC9C8\uBB38 \uC720\uD615").setDesc("\uAE30\uBCF8\uC73C\uB85C \uD65C\uC131\uD654\uD560 \uC9C8\uBB38 \uC720\uD615\uC744 \uC120\uD0DD\uD558\uC138\uC694");let t=e.createDiv({cls:"socratic-question-types-container"});d.all().forEach(n=>{let i=n.getInfo();new m.Setting(t).setName(`${i.icon} ${i.displayText}`).setDesc(i.description).addToggle(r=>{r.setValue(this.plugin.settings.dialogue.defaultQuestionTypes.includes(i.type)).onChange(async a=>{let u=this.plugin.settings.dialogue.defaultQuestionTypes;if(a)u.includes(i.type)||u.push(i.type);else{let p=u.indexOf(i.type);p>-1&&u.splice(p,1)}await this.plugin.saveSettings()})})}),new m.Setting(e).setName("\uAE30\uBCF8 \uC9C8\uBB38 \uAC1C\uC218").setDesc("\uD55C \uBC88\uC5D0 \uC0DD\uC131\uD560 \uAE30\uBCF8 \uC9C8\uBB38 \uAC1C\uC218 (1-5)").addSlider(n=>{n.setLimits(1,5,1).setValue(this.plugin.settings.dialogue.defaultQuestionCount).setDynamicTooltip().onChange(async i=>{this.plugin.settings.dialogue.defaultQuestionCount=i,await this.plugin.saveSettings()})}),new m.Setting(e).setName("\uC790\uB3D9 \uC800\uC7A5").setDesc("\uB300\uD654 \uB0B4\uC6A9\uC744 \uB178\uD2B8\uC5D0 \uC790\uB3D9\uC73C\uB85C \uC800\uC7A5\uD569\uB2C8\uB2E4").addToggle(n=>{n.setValue(this.plugin.settings.dialogue.autoSaveDialogue).onChange(async i=>{this.plugin.settings.dialogue.autoSaveDialogue=i,await this.plugin.saveSettings()})})}populateModelDropdown(e,t){X(t).forEach(i=>{e.addOption(i.id,i.displayName)})}updateModelDropdown(){var t;if(!this.modelDropdown)return;let e=this.plugin.settings.ai.provider;this.modelDropdown.selectEl.empty(),this.populateModelDropdown(this.modelDropdown,e),this.modelDropdown.setValue((t=this.plugin.settings.ai.models[e])!=null?t:I[e].defaultModel)}};var P={ai:{provider:"claude",apiKeys:{},models:{claude:"claude-sonnet-4-5-20250929",openai:"gpt-5.2",gemini:"gemini-3-flash-preview",grok:"grok-4-1-fast"},budgetLimit:void 0},dialogue:{defaultIntensity:"MODERATE",defaultQuestionTypes:["ASSUMPTION","PERSPECTIVE","EXPANSION"],defaultQuestionCount:3,autoSaveDialogue:!0}};var F=class extends S.Plugin{constructor(){super(...arguments);this.aiService=null}async onload(){await this.loadSettings(),this.initializeAIService(),this.addCommand({id:"start-socratic-dialogue",name:"Start Socratic Dialogue",callback:()=>this.startDialogue()}),this.addCommand({id:"start-socratic-dialogue-for-current-note",name:"Start Socratic Dialogue for Current Note",checkCallback:e=>{let t=this.app.workspace.getActiveFile();return t?(e||this.startDialogueForFile(t),!0):!1}}),this.addRibbonIcon("message-circle","Socratic Challenger",()=>{this.startDialogue()}),this.addSettingTab(new x(this.app,this)),console.log("Socratic Challenger plugin loaded")}async onunload(){console.log("Socratic Challenger plugin unloaded")}async loadSettings(){let e=await this.loadData();this.settings={...P,ai:{...P.ai,apiKeys:{...P.ai.apiKeys},models:{...P.ai.models}},dialogue:{...P.dialogue,defaultQuestionTypes:[...P.dialogue.defaultQuestionTypes]}},e&&(e.ai&&(e.ai.provider&&(this.settings.ai.provider=e.ai.provider),e.ai.apiKeys&&(this.settings.ai.apiKeys={...this.settings.ai.apiKeys,...e.ai.apiKeys}),e.ai.models&&(this.settings.ai.models={...this.settings.ai.models,...e.ai.models}),e.ai.budgetLimit!==void 0&&(this.settings.ai.budgetLimit=e.ai.budgetLimit)),e.dialogue&&(e.dialogue.defaultIntensity&&(this.settings.dialogue.defaultIntensity=e.dialogue.defaultIntensity),e.dialogue.defaultQuestionTypes&&(this.settings.dialogue.defaultQuestionTypes=e.dialogue.defaultQuestionTypes),e.dialogue.defaultQuestionCount!==void 0&&(this.settings.dialogue.defaultQuestionCount=e.dialogue.defaultQuestionCount),e.dialogue.autoSaveDialogue!==void 0&&(this.settings.dialogue.autoSaveDialogue=e.dialogue.autoSaveDialogue)))}async saveSettings(){await this.saveData(this.settings),this.updateAIService()}initializeAIService(){this.aiService=U(this.settings.ai),[["claude",new w],["openai",new E],["gemini",new k],["grok",new O]].forEach(([t,n])=>{var a,u;let i=this.settings.ai.apiKeys[t];i&&n.setApiKey(i);let r=(a=this.settings.ai.models[t])!=null?a:I[t].defaultModel;n.setModel(r),(u=this.aiService)==null||u.registerProvider(t,n)})}updateAIService(){z(this.settings.ai);let e=j();e&&["claude","openai","gemini","grok"].forEach(t=>{var i;let n=e.providers.get(t);if(n){let r=this.settings.ai.apiKeys[t];r&&n.setApiKey(r);let a=(i=this.settings.ai.models[t])!=null?i:I[t].defaultModel;n.setModel(a)}})}getCurrentProvider(){var e;return(e=this.aiService)==null?void 0:e.getCurrentProvider()}async startDialogue(){let e=this.app.workspace.getActiveFile();if(!e){new S.Notice("\uB178\uD2B8\uB97C \uC5F4\uC5B4\uC8FC\uC138\uC694.");return}await this.startDialogueForFile(e)}async startDialogueForFile(e){var t;if(!((t=this.aiService)!=null&&t.isAvailable())){new S.Notice("AI \uC124\uC815\uC744 \uBA3C\uC800 \uC644\uB8CC\uD574\uC8FC\uC138\uC694. (\uC124\uC815 \u2192 Socratic Challenger)");return}try{let n=await this.app.vault.read(e);if(!n.trim()){new S.Notice("\uB178\uD2B8 \uB0B4\uC6A9\uC774 \uBE44\uC5B4\uC788\uC2B5\uB2C8\uB2E4.");return}new N(this.app,this,n,e.path).open()}catch(n){let i=n instanceof Error?n.message:"\uB178\uD2B8\uB97C \uC77D\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.";new S.Notice(`\uC624\uB958: ${i}`)}}};
